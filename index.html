<!DOCTYPE html>
<html lang="zh-Hans">

<head>
<link rel="stylesheet" href="css/style.css">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width",user-scalable=no,initial-scale=1.0,maximum-scale=1>
	<title></title>
</head>
<body>
		
			<canvas id="painting"></canvas>
			<div class="actions" id="actions">
		    <button id="eraser">橡皮擦</button>
			<button id="brush">画笔</button>
			</div>
		


<script>
	
	var canvas = document.getElementById('painting'); 
	var context = canvas.getContext('2d');

	autoSetCanvasSize();

	listenToMouse();

	/*****监听******/
	function listenToMouse(){
		var lastPoint = {x:undefined,y:undefined};
		var eraserEnabled = false;   //是否使用橡皮擦
	    var using = false;		// 是否按下

	    if(document.body.ontouchstart !== undefined){  //触屏检测

	   	   /*****触屏*****/
	    	canvas.ontouchstart = function(aaa){
	    		var x = aaa.touches[0].clientX;
	    		var y = aaa.touches[0].clientY;
	    		using = true;
				lastPoint = {'x':x,'y':y};	
	    	}
	    	canvas.ontouchmove = function(aaa){
	    		var x = aaa.touches[0].clientX;
	    		var y = aaa.touches[0].clientY;

	    		if(!using){return}

				if(eraserEnabled){
					context.clearRect(x-5,y-5,10,10);
					}
				else {
					var newPoint = {'x':x,'y':y};
					drawLine(lastPoint.x,lastPoint.y,newPoint.x,newPoint.y);
					lastPoint = newPoint;
					}	
	    	}
	    	canvas.ontouchend = function(){
	    		using = false;
	    	}
	    	eraser.onclick = function(){
				actions.className = 'actions x';
				eraserEnabled = true;
			}
			brush.onclick = function(){
				actions.className = 'actions';
		   		eraserEnabled = false;
			}

	    }

	    else{
	    	/*****非触屏*****/
			canvas.onmousedown = function(a){
			using = true;
			var x = a.clientX;
			var y = a.clientY;
			lastPoint = {'x':x,'y':y}
			}
			canvas.onmousemove = function(a){
			var x = a.clientX;
			var y = a.clientY;

			if(!using){return}
    			
			if(eraserEnabled){
				context.clearRect(x-5,y-5,10,10);
				}
			else {
				var newPoint = {'x':x,'y':y};
				drawLine(lastPoint.x,lastPoint.y,newPoint.x,newPoint.y);
				lastPoint = newPoint;
				}	
			}
			canvas.onmouseup = function(a){
				using = false;
			}
			
			eraser.onclick = function(){
				actions.className = 'actions x';
				eraserEnabled = true;
			}
			brush.onclick = function(){
				actions.className = 'actions';
		   		eraserEnabled = false;
			}

	    }




	}
	/*****调整canvas大小******/
	function autoSetCanvasSize(){
		setCanvasSize();        //全屏canvas
		window.onresize = function(){
		setCanvasSize();
		}
		function setCanvasSize(){
				var pageHeight = document.documentElement.clientHeight;
				var pageWidth = document.documentElement.clientWidth;
				canvas.height = pageHeight;
				canvas.width = pageWidth;
		}
	}
	
	function drawLine(x1,y1,x2,y2) {
		context.beginPath();
		context.moveTo(x1,y1);
		context.lineWidth = 2;
		context.lineTo(x2,y2);
		context.stroke();
		context.closePath();
	}
	function drawCircle(x,y,radius) {
		context.beginPath();
		context.arc(x,y,radius,0,2*Math.PI);
		context.stroke();
	}
	

</script>
</body>
</html>